{% extends "base.html" %} {% block title %}index page{% endblock %} {% block
body %}

<h1>WebSocket Chat</h1>
<h2>Your Name: <span id="ws-id"></span></h2>
<form action="" onsubmit="sendMessage(event)">
  <input type="text" id="messageText" autocomplete="off" />
  <button>Send</button>
</form>
<ul id="messages"></ul>
<script>
  var client_name = prompt("What is your name?");
  document.querySelector("#ws-id").textContent = client_name;
  var ws = new WebSocket(`ws://localhost:8000/ws/${client_name}`);
  ws.onmessage = function (event) {
    var messages = document.getElementById("messages");
    var message = document.createElement("li");
    var content = document.createTextNode(event.data);
    message.appendChild(content);
    messages.appendChild(message);
  };
  function sendMessage(event) {
    var input = document.getElementById("messageText");
    ws.send(input.value);
    input.value = "";
    event.preventDefault();
  }
</script>
{% endblock %}
